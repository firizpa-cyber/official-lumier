<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANT-OTT-PLAYER - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            font-size: 36px;
            font-weight: 700;
        }

        /* –ì–ê–õ–ï–†–ï–Ø */
        .movies-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #212529;
            margin-bottom: 20px;
        }

        .movies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        .movie-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .movie-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
        }

        .movie-card.active {
            border: 3px solid #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .movie-poster {
            width: 100%;
            height: 300px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 64px;
        }

        .movie-info {
            padding: 15px;
        }

        .movie-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .movie-quality {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        /* –ü–õ–ï–ï–† */
        .player-section {
            margin-bottom: 30px;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
        }

        video {
            width: 100%;
            display: block;
        }

        /* –≠–õ–ï–ú–ï–ù–¢–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
        .test-controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .test-controls h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-label {
            font-size: 14px;
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }

        button:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button.btn-success {
            background: #28a745;
        }

        button.btn-success:hover {
            background: #218838;
        }

        button.btn-warning {
            background: #ffc107;
            color: #212529;
        }

        button.btn-warning:hover {
            background: #e0a800;
        }

        button.active {
            border: 2px solid #fff;
            box-shadow: 0 0 0 2px #667eea;
        }

        /* –ö–û–ù–°–û–õ–¨ */
        .console-section {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 20px;
        }

        .console-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .console-title {
            color: #9cdcfe;
            font-size: 14px;
            font-weight: 600;
            font-family: monospace;
        }

        .clear-btn {
            background: #6c757d;
            padding: 6px 12px;
            font-size: 12px;
        }

        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.6;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 15px;
        }

        .console-output::-webkit-scrollbar {
            width: 10px;
        }

        .console-output::-webkit-scrollbar-track {
            background: #2d2d2d;
        }

        .console-output::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 5px;
        }

        .log-entry {
            margin-bottom: 4px;
        }

        .log-timestamp {
            color: #858585;
            margin-right: 8px;
        }

        .log-success {
            color: #4ec9b0;
        }

        .log-error {
            color: #f48771;
        }

        .log-warning {
            color: #dcdcaa;
        }

        .log-info {
            color: #9cdcfe;
        }

        .log-section {
            color: #c586c0;
            font-weight: bold;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #333;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üé¨ ANT-OTT-PLAYER - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h1>

        <div class="movies-section">
            <div class="section-title">üçø –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º</div>
            <div class="movies-grid" id="movies-grid"></div>
        </div>

        <div class="player-section">
            <video id="main-video" controls></video>
        </div>

        <div class="test-controls">
            <h3>üß™ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–µ—Ä–æ–º</h3>

            <div class="control-group">
                <div class="control-label">üé¨ –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ:</div>
                <div class="btn-group" id="quality-buttons">
                    <button disabled>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ</button>
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">üéµ –ê—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏:</div>
                <div class="btn-group" id="audio-buttons">
                    <button disabled>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ</button>
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">üìù –°—É–±—Ç–∏—Ç—Ä—ã:</div>
                <div class="btn-group" id="subtitle-buttons">
                    <button disabled>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ</button>
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">‚öô –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:</div>
                <div class="btn-group">
                    <button class="btn-success" onclick="checkInfo()">‚Ñπ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ñ–æ</button>
                    <button class="btn-warning" onclick="playPause()">‚ñ∂ Play/Pause</button>
                </div>
            </div>
        </div>

        <div class="console-section">
            <div class="console-header">
                <div class="console-title">üìü CONSOLE OUTPUT</div>
                <button class="clear-btn" onclick="clearConsole()">üóë –û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
            <div class="console-output" id="console"></div>
        </div>
    </div>

    <script src="https://cdn.js delivr.net/npm/hls.js@latest"></script>
    <script src="assets/js/player-core.js"></script>
    <script src="modules/audio/player-audio.js"></script>
    <script src="modules/subtitles/player-subtitles.js"></script>

    <script>
        const movies = [
            {
                title: '–ë–∞–ª–µ—Ä–∏–Ω–∞',
                url: 'http://ant-tv.ddns.net/ANIME_TV/index.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/balerina.jpg',
                emoji: 'ü©∞',
                year: '2025'
            },
            {
                title: '–ê—Ä–≥–∞–π–ª: –°—É–ø–µ—Ä—à–ø –∏–æ–Ω',
                url: 'http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Argay_lsupershpion_2024/master.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/argylle.jpg',
                emoji: 'üïµÔ∏è',
                year: '2024'
            },
            {
                title: '–ê–ø–≥—Ä–µ–π–¥',
                url: 'http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Apgreyd.2018/master.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/upgrade.jpg',
                emoji: 'ü§ñ',
                year: '2018'
            },
            {
                title: '–ê–Ω–Ω–∞',
                url: 'http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Anna.2019/master.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/anna.jpg',
                emoji: 'üî´',
                year: '2019'
            },
            {
                title: '–ê–ª–∏, —Ä—É–ª–∏!',
                url: 'http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Ali.ruli/master.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/ali_ruli.jpg',
                emoji: 'üöó',
                year: '2023'
            },
            {
                title: '–ê–¥—Ä–µ–Ω–∞–ª–∏–Ω',
                url: 'http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Adrenaline/master.m3u8',
                poster: 'http://ant-tv.ddns.net:2223/uploads/posters/adrenaline.jpg',
                emoji: '‚ö°',
                year: '2006'
            }
        ];

        let player = null;

        function init() {
            renderMovies();
            initPlayer();
            log('üé¨ –ü–ª–µ–µ—Ä –≥–æ—Ç–æ–≤! –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –∏–∑ –≥–∞–ª–µ—Ä–µ–∏', 'success');
            log('‚Ñπ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ "–±–∏—Ç–æ–º audio –ø–ª–µ–π–ª–∏—Å—Ç–µ" - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ü–ª–µ–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –±–∏—Ç—ã–µ —Ç—Ä–µ–∫–∏.', 'info');
        }

        function renderMovies() {
            const grid = document.getElementById('movies-grid');
            movies.forEach((movie, index) => {
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.onclick = () => loadMovie(index);

                // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –ø–æ—Å—Ç–µ—Ä, –µ—Å–ª–∏ –Ω–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏
                const posterStyle = movie.poster ?
                    `background-image: url('${movie.poster}');` :
                    '';

                card.innerHTML = `
                    <div class="movie-poster" style="${posterStyle}">
                        ${!movie.poster ? movie.emoji : ''}
                    </div>
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <span class="movie-quality">HLS ‚Ä¢ ${movie.year}</span>
                    </div>
                `;

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏  –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                const poster = card.querySelector('.movie-poster');
                const img = new Image();
                img.onerror = () => {
                    poster.style.backgroundImage = '';
                    poster.textContent = movie.emoji;
                };
                img.src = movie.poster;

                grid.appendChild(card);
            });
        }

        function initPlayer() {
            player = new ProVideoPlayer({
                videoElement: 'main-video',
                container: 'player-section',
                autoplay: false
            });

            player.audio = new PlayerAudio(player);
            player.subtitles = new PlayerSubtitles(player);

            player.on('manifestparsed', () => {
                log('‚úÖ –ú–∞–Ω–∏—Ñ–µ—Å—Ç –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
                updateQualityButtons();
            });
            player.on('audiotracksupdate', (tracks) => {
                log(`üéµ –ê—É–¥–∏–æ-–¥–æ—Ä–æ–∂–µ–∫: ${tracks.length}`, 'success');
                updateAudioButtons(tracks);
            });
            player.on('subtitlestracksupdate', (tracks) => {
                log(`üìù –°—É–±—Ç–∏—Ç—Ä–æ–≤: ${tracks.length}`, 'success');
                updateSubtitleButtons(tracks);
            });
            player.on('qualitychange', (q) => {
                log(`üé¨ –ö–∞—á–µ—Å—Ç–≤–æ: ${q.height}p`, 'success');
            });
        }

        function loadMovie(index) {
            const movie = movies[index];
            document.querySelectorAll('.movie-card').forEach((card, i) => {
                card.classList.toggle('active', i === index);
            });
            logSection(`–ó–ê–ì–†–£–ó–ö–ê: ${movie.title}`);
            log(`${movie.emoji} ${movie.title} (${movie.year})`, 'info');
            player.loadSource(movie.url, 'hls');
        }

        function updateQualityButtons() {
            const container = document.getElementById('quality-buttons');
            container.innerHTML = '';

            player.hls.levels.forEach((level, index) => {
                const btn = document.createElement('button');
                btn.textContent = `${level.height}p`;
                btn.onclick = () => setQuality(index);
                container.appendChild(btn);
            });

            const autoBtn = document.createElement('button');
            autoBtn.textContent = 'Auto';
            autoBtn.className = 'active';
            autoBtn.onclick = () => setQuality(-1);
            container.appendChild(autoBtn);
        }

        function setQuality(index) {
            if (index === -1) {
                player.setAutoQuality();
                log('üé¨ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: Auto', 'success');
            } else {
                player.setQuality(index);
                log(`üé¨ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: ${player.hls.levels[index].height}p`, 'success');
            }
            updateActiveButton('quality-buttons', index === -1 ? 'Auto' : `${player.hls.levels[index].height}p`);
        }

        function updateAudioButtons(tracks) {
            const container = document.getElementById('audio-buttons');
            container.innerHTML = '';

            tracks.forEach((track, index) => {
                const btn = document.createElement('button');
                btn.textContent = `${track.name} (${track.lang})`;
                btn.onclick = () => setAudio(track.id);
                if (index === 0) btn.className = 'active';
                container.appendChild(btn);
            });
        }

        function setAudio(id) {
            player.audio.setTrack(id);
            const track = player.audio.tracks.find(t => t.id === id);
            log(`üéµ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: ${track.name}`, 'success');
            updateActiveButton('audio-buttons', `${track.name} (${track.lang})`);
        }

        function updateSubtitleButtons(tracks) {
            const container = document.getElementById('subtitle-buttons');
            container.innerHTML = '';

            const offBtn = document.createElement('button');
            offBtn.textContent = '–í—ã–∫–ª—é—á–µ–Ω–æ';
            offBtn.className = 'active';
            offBtn.onclick = () => setSubtitle(-1);
            container.appendChild(offBtn);

            tracks.forEach((track) => {
                const btn = document.createElement('button');
                btn.textContent = track.label;
                btn.onclick = () => setSubtitle(track.id);
                container.appendChild(btn);
            });
        }

        function setSubtitle(id) {
            if (id === -1) {
                player.subtitles.disable();
                log('üìù –°—É–±—Ç–∏—Ç—Ä—ã –≤—ã–∫–ª—é—á–µ–Ω—ã', 'info');
                updateActiveButton('subtitle-buttons', '–í—ã–∫–ª—é—á–µ–Ω–æ');
            } else {
                player.subtitles.setTrack(id);
                const track = player.subtitles.tracks.find(t => t.id === id);
                log(`üìù –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: ${track.label}`, 'success');
                updateActiveButton('subtitle-buttons', track.label);
            }
        }

        function updateActiveButton(containerId, text) {
            const container = document.getElementById(containerId);
            container.querySelectorAll('button').forEach(btn => {
                btn.classList.toggle('active', btn.textContent === text);
            });
        }

        function checkInfo() {
            if (!player || !player.hls) {
                log('‚ö† –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ!', 'warning');
                return;
            }
            logSection('–ò–ù–§–û–†–ú–ê–¶–ò–Ø');
            log(`üìä –£—Ä–æ–≤–Ω–µ–π: ${player.hls.levels.length}`, 'info');
            log(`üéµ –ê—É–¥–∏–æ: ${player.hls.audioTracks?.length || 0}`, 'info');
            log(`üìù –°—É–±—Ç–∏—Ç—Ä—ã: ${player.subtitles?.tracks?.length || 0}`, 'info');
        }

        function playPause() {
            player.video.paused ? player.play() : player.pause();
        }

        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.innerHTML = `<span class="log-timestamp">[${time}]</span>${message}`;
            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
        }

        function logSection(title) {
            const console = document.getElementById('console');
            const entry = document.createElement('div');
            entry.className = 'log-entry log-section';
            entry.textContent = `\n========== ${title} ==========`;
            console.appendChild(entry);
        }

        function clearConsole() {
            document.getElementById('console').innerHTML = '';
        }

        window.onload = init;
    </script>
</body>

</html>