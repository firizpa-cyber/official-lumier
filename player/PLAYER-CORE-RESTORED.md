# ‚úÖ –ì–û–¢–û–í–û: Player Core –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!

## üéâ –§–ê–ô–õ –ü–û–õ–ù–û–°–¢–¨–Æ –ü–ï–†–ï–ü–ò–°–ê–ù

–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π `player-core.js` —Å –Ω—É–ª—è —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏.

### ‚úÖ –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ:

#### 1. **YouTube-Style –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è**
```javascript
maxBufferLength: 30,        // 30s –≤–ø–µ—Ä—ë–¥
backBufferLength: 30,       // 30s –Ω–∞–∑–∞–¥  
maxBufferSize: 100MB,       // –û–±—ä—ë–º –±—É—Ñ–µ—Ä–∞
highBufferWatchdogPeriod: 2 // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 2s
```

#### 2. **–ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞**
```javascript
abrBandWidthFactor: 0.95,   // –ó–∞–ø–∞—Å 5%
abrBandWidthUpFactor: 0.7,  // –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ
startFragPrefetch: true,    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ
```

#### 3. **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏—Ç—ã—Ö `audio*.m3u8` –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤
- ‚úÖ –ê–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –º–µ–¥–∏–∞ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ü–æ–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ `bufferStalledError`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π

#### 4. **–ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π**
```javascript
Events.MANIFEST_PARSED      ‚Üí ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ
Events.AUDIO_TRACKS_UPDATED ‚Üí ‚úÖ –ê—É–¥–∏–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ  
Events.LEVEL_SWITCHED       ‚Üí ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–µ–Ω–æ
Events.ERROR                ‚Üí ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```

#### 5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —ç–º–æ–¥–∑–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞:
```
‚úÖ –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω
üéµ –ê—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: 3
üé¨ –ö–∞—á–µ—Å—Ç–≤–æ: 1080p, 5000 kbps
‚ö† –ë–∏—Ç—ã–π audio –ø–ª–µ–π–ª–∏—Å—Ç, –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
üîÑ –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ...
‚è∏ –ë—É—Ñ–µ—Ä –∑–∞—Å—Ç—Ä—è–ª, –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
```

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HLS.js:
- **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è**: 30+30 —Å–µ–∫—É–Ω–¥ (–∫–∞–∫ YouTube)
- **–¢–∞–π–º–∞—É—Ç—ã**: 10-20s —Å 4-6 retry
- **ABR**: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –±–∏—Ç—Ä–µ–π—Ç —Å –∑–∞–ø–∞—Å–æ–º 5%
- **Seek**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–±–µ–ª–æ–≤ –¥–æ 2s
- **–ü—Ä–æ–∫—Å–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö URL

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:

**–§–∞—Ç–∞–ª—å–Ω—ã–µ:**
- `NETWORK_ERROR` ‚Üí startLoad()
- `MEDIA_ERROR` ‚Üí recoverMediaError()
- `levelParsingError` (audio) ‚Üí ignore

**Non-fatal:**
- `bufferStalledError` ‚Üí –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ + reload
- `bufferAppendingError` ‚Üí retry
- `fragLoadError` ‚Üí retry

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞:
```
http://localhost:8000/player/diagnostic.html
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–µ–µ—Ä–∞
2. –ó–∞–≥—Ä—É–∑–∫–∞ HLS
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (–∫–Ω–æ–ø–∫–∏ 360p, 480p, 720p, 1080p)
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É–¥–∏–æ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Ä–æ–∂–∫–∏)
5. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### 2. –û—Å–Ω–æ–≤–Ω–æ–π –ø–ª–µ–µ—Ä:
```
http://localhost:8000/player/
```

**–ó–∞–≥—Ä—É–∑–∏—Ç–µ URL:**
```
http://ant-tv.ddns.net/vod/hls/lun4/KINOTK/Odin.doma.1990.BDRip-AVC/master.m3u8
```

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[Player] –ó–∞–≥—Ä—É–∑–∫–∞ HLS (YouTube-optimized): ...
[Player] ‚úÖ –ú–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω
[Player] üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞: 360p, 480p, 720p, 1080p
[Player] üéµ –ê—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: 2
[Player] üé¨ –ö–∞—á–µ—Å—Ç–≤–æ: 1080p, 5000 kbps
```

## ‚ú® –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

‚úÖ **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞** - –ø–ª–∞–≤–Ω–æ–µ, –±–µ–∑ –∑–∞–≤–∏—Å–∞–Ω–∏–π  
‚úÖ **–°–º–µ–Ω–∞ –∞—É–¥–∏–æ** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Ä–æ–∂–µ–∫
‚úÖ **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è** - 30s –≤–ø–µ—Ä—ë–¥, –∫–∞–∫ –≤ YouTube
‚úÖ **–ê–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –≤—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤–∏–¥–Ω–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
‚úÖ **–ë–∏—Ç—ã–µ –ø–ª–µ–π–ª–∏—Å—Ç—ã** - –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üìù API –ú–µ—Ç–æ–¥—ã:

```javascript
// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º
player.play()
player.pause()
player.togglePlay()
player.seek(time)

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å—é
player.setVolume(0.5)
player.toggleMute()

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–æ–º
player.setQuality(2)        // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 720p
player.setAutoQuality()     // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é
player.setPlaybackRate(1.5)

// –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
player.getState()

// –°–æ–±—ã—Ç–∏—è
player.on('manifestparsed', callback)
player.on('audiotracksupdate', callback)
player.on('qualitychange', callback)
player.on('error', callback)
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ diagnostic.html** –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–ª–µ–µ—Ä**
3. **–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è**
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏**

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –§–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤!  
**–ö–∞—á–µ—Å—Ç–≤–æ**: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ, YouTube-level  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ
