# üéØ –ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï: HLS –∏–∑ File-Browser

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–ª–µ–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã file-browser:
- –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ master.m3u8
- –ü—Ä–æ—Ñ–∏–ª–∏ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ –ø–∞–ø–∫–∞–º (profile_1_360p, profile_2_480p –∏ —Ç.–¥.)
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞/–∞—É–¥–∏–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

## –†–µ—à–µ–Ω–∏–µ ‚úÖ

### 1. –°–æ–∑–¥–∞–Ω HLS Loader (`hls-loader.php`)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É file-browser
- –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç master.m3u8 –Ω–∞ –ª–µ—Ç—É
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π HLS –ø–ª–µ–π–ª–∏—Å—Ç

**API:**

```php
// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∏–¥–µ–æ
GET /player/hls-loader.php?action=info&lun=lun1&path=Fantasticheskaya.4.pervie.shagi.2025.WEB-DL.1080p

–û—Ç–≤–µ—Ç:
{
  "success": true,
  "lun": "lun1",
  "path": "Fantasticheskaya.4.pervie.shagi.2025.WEB-DL.1080p",
  "profiles": [
    {"name": "profile_1_360p", "number": 1, "resolution": 360, "height": 360},
    {"name": "profile_2_480p", "number": 2, "resolution": 480, "height": 480},
    {"name": "profile_3_720p", "number": 3, "resolution": 720, "height": 720},
    {"name": "profile_4_1080p", "number": 4, "resolution": 1080, "height": 1080}
  ],
  "masterUrl": "?action=master&lun=lun1&path=..."
}

// –ü–æ–ª—É—á–∏—Ç—å master.m3u8
GET /player/hls-loader.php?action=master&lun=lun1&path=Fantasticheskaya.4.pervie.shagi.2025.WEB-DL.1080p

–û—Ç–≤–µ—Ç:
#EXTM3U
#EXT-X-VERSION:3

#EXT-X-STREAM-INF:BANDWIDTH=800000,RESOLUTION=640x360,NAME="360p"
http://ant-tv.ddns.net/vod/hls/lun1/.../profile_1_360p/playlist.m3u8

#EXT-X-STREAM-INF:BANDWIDTH=1400000,RESOLUTION=854x480,NAME="480p"
http://ant-tv.ddns.net/vod/hls/lun1/.../profile_2_480p/playlist.m3u8

#EXT-X-STREAM-INF:BANDWIDTH=2800000,RESOLUTION=1280x720,NAME="720p"
http://ant-tv.ddns.net/vod/hls/lun1/.../profile_3_720p/playlist.m3u8

#EXT-X-STREAM-INF:BANDWIDTH=5000000,RESOLUTION=1920x1080,NAME="1080p"
http://ant-tv.ddns.net/vod/hls/lun1/.../profile_4_1080p/playlist.m3u8
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Favicon
- –î–æ–±–∞–≤–ª–µ–Ω `favicon.svg`
- –ü–æ–¥–∫–ª—é—á–µ–Ω –≤ `index.php`
- –ë–æ–ª—å—à–µ –Ω–µ—Ç 404 –æ—à–∏–±–∫–∏

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- `bufferStalledError` - –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
- Non-fatal –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HLS Loader

–û—Ç–∫—Ä–æ–π—Ç–µ:
```
http://localhost:8000/player/test-hls-loader.html
```

1. –ù–∞–∂–º–∏—Ç–µ "Get Video Info" - —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏
2. –ù–∞–∂–º–∏—Ç–µ "Get Master.m3u8" - —É–≤–∏–¥–∏—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç
3. –ù–∞–∂–º–∏—Ç–µ "Load Video" - –≤–∏–¥–µ–æ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ –Ω–∞—á–Ω—ë—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–ª–µ–µ—Ä–µ

–í –ø–ª–µ–µ—Ä–µ –≤–≤–µ–¥–∏—Ç–µ URL:
```
http://localhost:8000/player/hls-loader.php?action=master&lun=lun1&path=Fantasticheskaya.4.pervie.shagi.2025.WEB-DL.1080p
```

–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" –∏ –ø–ª–µ–µ—Ä:
- ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ –ü–æ–∫–∞–∂–µ—Ç –º–µ–Ω—é —Å 360p, 480p, 720p, 1080p
- ‚úÖ –ü–æ–∑–≤–æ–ª–∏—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∞—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –ø–ª–µ–π–ª–∏—Å—Ç–∞—Ö)

## üìã –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### File-Browser —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
Fantasticheskaya.4.pervie.shagi.2025.WEB-DL.1080p/
‚îú‚îÄ‚îÄ profile_1_360p/
‚îÇ   ‚îú‚îÄ‚îÄ playlist.m3u8
‚îÇ   ‚îú‚îÄ‚îÄ segment_*.ts
‚îÇ   ‚îî‚îÄ‚îÄ audio1_segment_*.ts
‚îú‚îÄ‚îÄ profile_2_480p/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ profile_3_720p/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ profile_4_1080p/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ subtitles/
    ‚îî‚îÄ‚îÄ *.vtt
```

### HLS Loader –¥–µ–ª–∞–µ—Ç:
1. **–°–∫–∞–Ω–∏—Ä—É–µ—Ç** –ø–∞–ø–∫—É —á–µ—Ä–µ–∑ file-browser API
2. **–ù–∞—Ö–æ–¥–∏—Ç** –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏ (profile_*_*p)
3. **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç** master.m3u8 —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ STREAM-INF –∑–∞–ø–∏—Å—è–º–∏
4. **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç** –ø–ª–µ–π–ª–∏—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π HLS.js –ø–æ–Ω–∏–º–∞–µ—Ç

### –ü–ª–µ–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç:
- –í—Å–µ —É—Ä–æ–≤–Ω–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (360p, 480p, 720p, 1080p)
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ URL –∫ –ø–ª–µ–π–ª–∏—Å—Ç–∞–º –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
- –ë–∏—Ç—Ä–µ–π—Ç—ã –¥–ª—è ABR
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è UI

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
1. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞** - –º–µ–Ω—é —Å 4 –ø—Ä–æ—Ñ–∏–ª—è–º–∏
2. **–ê—É–¥–∏–æ-–¥–æ—Ä–æ–∂–∫–∏** - –µ—Å–ª–∏ –µ—Å—Ç—å –≤ –ø–ª–µ–π–ª–∏—Å—Ç–∞—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
3. **–°—É–±—Ç–∏—Ç—Ä—ã** - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
4. **ABR** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞
5. **Buffer—Ç–∞–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### üìù –î–ª—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤:
–ù—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å loader, —á—Ç–æ–±—ã –æ–Ω:
1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–ª –ø–∞–ø–∫—É `subtitles/`
2. –î–æ–±–∞–≤–ª—è–ª `#EXT-X-MEDIA:TYPE=SUBTITLES` –≤ master.m3u8

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:**
```
http://localhost:8000/player/test-hls-loader.html
```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:**
- Get Video Info ‚Üí –≤–∏–¥–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∏
- Get Master.m3u8 ‚Üí –≤–∏–¥–∏—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç
- Load Video ‚Üí –≤–∏–¥–µ–æ –∏–≥—Ä–∞–µ—Ç

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–ª–µ–µ—Ä–µ:**
```
http://localhost:8000/player/
```
URL: `http://localhost:8000/player/hls-loader.php?action=master&lun=lun1&path=–ò–ú–Ø_–ü–ê–ü–ö–ò`

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ HLS Loader –≥–æ—Ç–æ–≤ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!  
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –≤–∏–¥–µ–æ
