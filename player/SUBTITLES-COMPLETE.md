# ‚úÖ –ì–û–¢–û–í–û: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞!

## üéâ –°—É–±—Ç–∏—Ç—Ä—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—Ç!

### ‚ú® –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

#### 1. **–ú–æ–¥—É–ª—å PlayerSubtitles** (`player-subtitles.js`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –∏–∑ HLS –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö VTT —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ WebVTT —Ñ–æ—Ä–º–∞—Ç–∞
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–æ—Ä–æ–∂–∫–∞–º–∏
- ‚úÖ –í—ã–∫–ª—é—á–µ–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä–æ–≤

#### 2. **UI –¥–ª—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤**
- ‚úÖ –ú–µ–Ω—é —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –≤ –ø–ª–µ–µ—Ä–µ
- ‚úÖ –ö–Ω –æ–ø–∫–∞ "–í—ã–∫–ª—é—á–µ–Ω–æ"
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–æ—Ä–æ–∂–µ–∫
- ‚úÖ –û—Ç–º–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –¥–æ—Ä–æ–∂–∫–∏

#### 3. **–°–æ–±—ã—Ç–∏—è**
```javascript
player.on('subtitlestracksupdate', (tracks) => {
    // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
    console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—É–±—Ç–∏—Ç—Ä—ã:', tracks);
});

player.on('subtitletrackchange', (track) => {
    // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–æ—Ä–æ–∂–∫–∏
    console.log('–ê–∫—Ç–∏–≤–Ω–∞—è –¥–æ—Ä–æ–∂–∫–∞:', track);
});
```

## üìã API –ú–µ—Ç–æ–¥—ã:

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
```javascript
const tracks = player.subtitles.getTracks();
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤:
// [
//   { id: 0, label: "Russian", language: "ru", kind: "subtitles" },
//   { id: 1, label: "English", language: "en", kind: "subtitles" }
// ]
```

### –í–∫–ª—é—á–∏—Ç—å –¥–æ—Ä–æ–∂–∫—É
```javascript
player.subtitles.setTrack(0);  // –í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–≤—É—é –¥–æ—Ä–æ–∂–∫—É
player.subtitles.setTrack(-1); // –í—ã–∫–ª—é—á–∏—Ç—å —Å—É–±—Ç–∏—Ç—Ä—ã
player.subtitles.disable();    // –í—ã–∫–ª—é—á–∏—Ç—å (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
```

### –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–æ—Ä–æ–∂–∫—É
```javascript
const current = player.subtitles.getCurrentTrack();
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
// { id: 0, label: "Russian", language: "ru", ... }
// –∏–ª–∏ null –µ—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ
```

### –î–æ–±–∞–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä—ã
```javascript
player.subtitles.addExternalTrack('subtitles/russian.vtt', {
    label: '–†—É—Å—Å–∫–∏–π',
    language: 'ru',
    kind: 'subtitles',
    isDefault: true  // –í–∫–ª—é—á–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
});
```

## üé¨ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑ HLS**
–ö–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è master.m3u8 —Å –∑–∞–ø–∏—Å—è–º–∏ —Ç–∏–ø–∞:
```m3u8
#EXT-X-MEDIA:TYPE=SUBTITLES,GROUP-ID="subs",NAME="Russian",LANGUAGE="ru",URI="russian.m3u8"
#EXT-X-MEDIA:TYPE=SUBTITLES,GROUP-ID="subs",NAME="English",LANGUAGE="en",URI="english.m3u8"
```

HLS.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–æ—Ä–æ–∂–∫–∏, –∏ –º–æ–¥—É–ª—å –∏—Ö –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç.

### 2. **–ü–∞—Ä—Å–∏–Ω–≥ VTT**
–ú–æ–¥—É–ª—å —É–º–µ–µ—Ç –ø–∞—Ä—Å–∏—Ç—å WebVTT —Ñ–æ—Ä–º–∞—Ç:
```
WEBVTT

00:00:01.000 --> 00:00:04.000
–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!

00:00:05.000 --> 00:00:08.000
–≠—Ç–æ —Å—É–±—Ç–∏—Ç—Ä—ã
```

### 3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**
–ë—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—É–±—Ç–∏—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º `textTracks`.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –° HLS —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏
```javascript
// –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ —Å —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ
player.loadSource('http://example.com/video/master.m3u8');

// –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–æ–±—ã—Ç–∏—è
player.on('subtitlestracksupdate', (tracks) => {
    console.log('üìù –ù–∞–π–¥–µ–Ω–æ —Å—É–±—Ç–∏—Ç—Ä–æ–≤:', tracks.length);
    
    // –û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é —Å—É–±—Ç–∏—Ç—Ä–æ–≤ –≤ –ø–ª–µ–µ—Ä–µ
    // –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ—Ä–æ–∂–∫—É
});
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ
```javascript
// –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
player.subtitles.addExternalTrack('./subtitles/russian.vtt', {
    label: '–†—É—Å—Å–∫–∏–π',
    language: 'ru',
    isDefault: true
});

// –°—É–±—Ç–∏—Ç—Ä—ã –ø–æ—è–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12):
```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–æ—Ä–æ–∂–∫–∏
window.VideoPlayerAPI.player.subtitles.getTracks()

// –í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–≤—É—é –¥–æ—Ä–æ–∂–∫—É
window.VideoPlayerAPI.player.subtitles.setTrack(0)

// –í—ã–∫–ª—é—á–∏—Ç—å
window.VideoPlayerAPI.player.subtitles.disable()
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

‚úÖ **WebVTT** (.vtt) - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç  
‚úÖ **HLS Subtitles** (EXT-X-MEDIA TYPE=SUBTITLES)  
‚ö† **SRT** - —Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ VTT

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è SRT –≤ VTT:
```javascript
// –ü—Ä–æ—Å—Ç–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
function srtToVtt(srtContent) {
    return 'WEBVTT\n\n' + srtContent
        .replace(/\{\\[^}]*\}/g, '')
        .replace(/(\d{2}):(\d{2}):(\d{2}),(\d{3})/g, '$1:$2:$3.$4');
}
```

## üé® –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤:

–ë—Ä–∞—É–∑–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ –º–æ–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ CSS:

```css
::cue {
    color: white;
    background-color: rgba(0, 0, 0, 0.8);
    font-size: 18px;
    font-family: Arial, sans-serif;
    text-shadow: 2px 2px 4px #000;
}

::cue(b) {
    font-weight: bold;
}

::cue(i) {
    font-style: italic;
}
```

## üìù –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```javascript
// –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ª–µ–µ—Ä–∞
player.loadSource('video.m3u8');

// –°–ª—É—à–∞–µ–º –ø–æ—è–≤–ª–µ–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä–æ–≤
player.on('subtitlestracksupdate', (tracks) => {
    console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å—É–±—Ç–∏—Ç—Ä–æ–≤: ${tracks.length}`);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ–º —Ä—É—Å—Å–∫–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
    const russian = tracks.find(t => t.language === 'ru');
    if (russian) {
        player.subtitles.setTrack(russian.id);
    }
});

// –ò–ª–∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤–Ω–µ—à–Ω–∏–µ
player.subtitles.addExternalTrack('subs/eng.vtt', {
    label: 'English',
    language: 'en'
});
```

## ‚ú® –ß—Ç–æ –µ—â—ë —É–º–µ–µ—Ç –º–æ–¥—É–ª—å:

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ  
‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ `textTracks.change`  
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ multiple —Å—É–±—Ç–∏—Ç—Ä–æ–≤  
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ `destroy()`  
‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üöÄ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–ª–µ–µ—Ä:
```
http://localhost:8000/player/
```

2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∏–¥–µ–æ —Å —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏

3. –ù–∞–≤–µ–¥–∏—Ç–µ –º—ã—à—å –Ω–∞ –ø–ª–µ–µ—Ä

4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É `CC` (closed_caption)

5. –í—ã–±–µ—Ä–∏—Ç–µ —Å—É–±—Ç–∏—Ç—Ä—ã –∏–∑ –º–µ–Ω—é!

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –°—É–±—Ç–∏—Ç—Ä—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—Ç!  
**–§–æ—Ä–º–∞—Ç—ã**: VTT, HLS Subtitles  
**API**: –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –º–µ—Ç–æ–¥–æ–≤
